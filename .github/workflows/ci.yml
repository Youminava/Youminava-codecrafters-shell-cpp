name: Test Pipeline

on:
  push:
  pull_request:

jobs:
  test:
    runs-on: ubuntu-latest
    container:
      image: bebra11111111/my-shell-app:latest
      options: --user root  # Для возможности копирования файлов
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Run tests and build package
        run: |
          # Копируем файлы в /mnt (как в GitLab CI)
          cp -r . /mnt/
          
          # Запускаем проверочный скрипт
          /opt/check.sh
          
          # Копируем собранный пакет из /mnt в текущую директорию
          cp /mnt/kubsh.deb .
          
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: kubsh-package
          path: kubsh.deb
          retention-days: 7  # Аналог expire_in: 1 week